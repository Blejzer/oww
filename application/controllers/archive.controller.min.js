(function(){angular.module("oneWordWorld").controller("ArchiveController",a);a.$inject=["$rootScope","$state","socket","$scope"];function a(b,e,c,d){d.types=[{typeID:"person",TypeName:"Person"},{typeID:"event",TypeName:"Event"}];console.log("ArchiveController loaded");if(b.archive){console.log("$rootScope.archive exists... removing");delete b.archive}var f=this;f.bar=0;f.submitDate=function(){console.log("vm.title ",f.sel1);console.log("vm.week ",f.week);var g=moment(f.week).format("YYYYWW");console.log("test",g);if(f.sel1){c.emit("checkarchive",f.sel1,g);console.log("checkarchive emited")}};c.on("checkOK",function(h){console.log("checkOK received");var g=JSON.parse(h);console.log("checkOK received",g[0]);b.archive=g[0];if(g[0].person_id){c.emit("newPersonPageLoaded",g[0].person_id)}else{if(g[0].event_id){c.emit("newEventPageLoaded",g[0].event_id)}}});c.on("disconnect",function(){delete b.archive;console.log("archive page socket disconnected");c.removeAllListeners()});d.options={chart:{type:"pieChart",height:500,x:function(g){return g.a},y:function(g){return g.c},showLabels:true,callback:function(){d3.selectAll(".nvd3.text g").style("fill","white")},duration:500,labelThreshold:0.01,labelSunbeamLayout:true,legend:{margin:{top:5,right:35,bottom:5,left:0}}}};c.on("eventPageSuccess",function(h){var g=JSON.parse(h);d.globalList=g;d.data=g});c.on("eventCtnPageSuccess",function(h){var g=[];var j=[];var i=JSON.parse(h);i.forEach(function(k){j=k.ewords;g.push({cont:k.cont,words:j})});d.contList=g});c.on("personPageSuccess",function(h){var g=JSON.parse(h);d.globalList=g;d.data=g});c.on("personCtnPageSuccess",function(i){var g=[];var j=[];var h=JSON.parse(i);h.forEach(function(k){j=k.pwords;g.push({cont:k.cont,words:j})});d.contList=g})}})();